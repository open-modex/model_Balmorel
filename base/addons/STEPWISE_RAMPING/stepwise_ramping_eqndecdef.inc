* Stepwise ramping Juan Gea Bermúdez 2018.


EQUATION  QRAMPU(Y,AAA,G,S,T)   'Unit up-ramping below unit up-gradient for unit on and below minimum fuel consumption during unit startup.';
EQUATION  QRAMPING_UP_BALANCE (Y,AAA,G,S,T)       'Equation that balances the total ramping up for each timestep';
EQUATION  QRAMPING_UP_RATE_CAPABILITY(Y,AAA,G,RAMPING_RATE,S,T)   'Equation that limits the ramping up of each generation technologys ramping rate for each timestep';
EQUATION  QRAMPD(Y,AAA,G,S,T)   'Unit down-ramping below unit down-gradient for unit on and below minimum fuel consumption during unit shutdown.';
EQUATION  QRAMPING_DOWN_BALANCE (Y,AAA,G,S,T)   'Equation that balances the total ramping down for each timestep';
EQUATION  QRAMPING_DOWN_RATE_CAPABILITY(Y,AAA,G,RAMPING_RATE,S,T) 'Equation that limits the ramping down of each generation technologys ramping rate for each timestep';


$ifi not %SEASONALLINKRAMPING%==yes $goto SEASONALLINKRAMPING_NO


*RAMP UP
QRAMPU(IAGK_HASORPOT(IY411,IA,IGUC),S,T)$((GDATA(IGUC,'GDUCRAMPU') LT CHRONOHOUR(S,T)) AND (NOT (ORD(S) EQ 1 AND (ORD(T) EQ 1))) AND IS3(S))..
-VGF_T(IY411,IA,IGUC,S-1,T--1)$(ORD(T) EQ 1) - VGF_T(IY411,IA,IGUC,S,T-1)$(NOT (ORD(T) EQ 1))
    + VGF_T(IY411,IA,IGUC,S,T)
         =L=
      ((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
      +VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)*GDATA(IGUC,'GDUCRAMPU')
;

QRAMPING_UP_BALANCE(IY411,IA,IGUC,S,T)$((NOT (ORD(S) EQ 1 AND (ORD(T) EQ 1)))  AND IAGK_HASORPOT(IY411,IA,IGUC) AND IS3(S))..

SUM(RAMPING_RATE,VRAMPING_UP(IY411,IA,IGUC,RAMPING_RATE,S,T))
=G=
-VGF_T(IY411,IA,IGUC,S-1,T--1)$(ORD(T) EQ 1) - VGF_T(IY411,IA,IGUC,S,T-1)$(NOT (ORD(T) EQ 1))
+  VGF_T(IY411,IA,IGUC,S,T)
;

QRAMPING_UP_RATE_CAPABILITY (IY411,IA,IGUC,RAMPING_RATE,S,T)$((NOT (ORD(T) EQ 1)) AND IAGK_HASORPOT(IY411,IA,IGUC) AND IRAMPING_G_CAPABILITY_UP(IGUC,RAMPING_RATE) AND IS3(S))..
VRAMPING_UP(IY411,IA,IGUC,RAMPING_RATE,S,T)
=L=
IRAMPING_G_CAPABILITY_UP(IGUC,RAMPING_RATE)*((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
+VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
/(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)

;



QRAMPD(IAGK_HASORPOT(IY411,IA,IGUC),S,T)$((GDATA(IGUC,'GDUCRAMPD') LT CHRONOHOUR(S,T)) AND (NOT (ORD(S) EQ 1 AND (ORD(T) EQ 1))) AND IS3(S))..

 +VGF_T(IY411,IA,IGUC,S-1,T--1)$(ORD(T) EQ 1) + VGF_T(IY411,IA,IGUC,S,T-1)$(NOT (ORD(T) EQ 1))
    - VGF_T(IY411,IA,IGUC,S,T)
         =L=
      ((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
      +VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)*GDATA(IGUC,'GDUCRAMPD')
;

QRAMPING_DOWN_BALANCE(IY411,IA,IGUC,S,T)$((NOT (ORD(S) EQ 1 AND (ORD(T) EQ 1)))  AND IAGK_HASORPOT(IY411,IA,IGUC) AND IS3(S))..
SUM(RAMPING_RATE,VRAMPING_DOWN(IY411,IA,IGUC,RAMPING_RATE,S,T))
=G=
+VGF_T(IY411,IA,IGUC,S-1,T--1)$(ORD(T) EQ 1) + VGF_T(IY411,IA,IGUC,S,T-1)$(NOT (ORD(T) EQ 1))
-  VGF_T(IY411,IA,IGUC,S,T)
;

QRAMPING_DOWN_RATE_CAPABILITY (IY411,IA,IGUC,RAMPING_RATE,S,T)$((NOT (ORD(T) EQ 1)) AND IAGK_HASORPOT(IY411,IA,IGUC) AND IRAMPING_G_CAPABILITY_DOWN(IGUC,RAMPING_RATE) AND IS3(S))..
VRAMPING_DOWN(IY411,IA,IGUC,RAMPING_RATE,S,T)
=L=
IRAMPING_G_CAPABILITY_DOWN(IGUC,RAMPING_RATE)*((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
+VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
/(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(S,T)

;

$label  SEASONALLINKRAMPING_NO

$ifi %SEASONALLINKRAMPING%==yes $goto SEASONALLINKRAMPING_YES

*RAMP UP
QRAMPU(IAGK_HASORPOT(IY411,IA,IGUC),IS3,T)$((GDATA(IGUC,'GDUCRAMPU') LT CHRONOHOUR(IS3,T)) AND (NOT (ORD(T) EQ CARD(T))))..

VGF_T(IY411,IA,IGUC,IS3,T+1)
    - VGF_T(IY411,IA,IGUC,IS3,T)
         =L=
      ((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
       +VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(IS3,T)*GDATA(IGUC,'GDUCRAMPU')
;

QRAMPING_UP_BALANCE(IY411,IA,IGUC,IS3,T)$((NOT (ORD(T) EQ CARD(T))) AND IAGK_HASORPOT(IY411,IA,IGUC))..


SUM(RAMPING_RATE,VRAMPING_UP(IY411,IA,IGUC,RAMPING_RATE,IS3,T+1))

=G=

VGF_T(IY411,IA,IGUC,IS3,T+1)
-  VGF_T(IY411,IA,IGUC,IS3,T)
;

QRAMPING_UP_RATE_CAPABILITY (IY411,IA,IGUC,RAMPING_RATE,IS3,T)$((NOT (ORD(T) EQ CARD(T))) AND IAGK_HASORPOT(IY411,IA,IGUC) AND IRAMPING_G_CAPABILITY_UP(IGUC,RAMPING_RATE))..
VRAMPING_UP(IY411,IA,IGUC,RAMPING_RATE,IS3,T)
=L=
IRAMPING_G_CAPABILITY_UP(IGUC,RAMPING_RATE)*((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
+VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
/(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(IS3,T)

;

QRAMPD(IAGK_HASORPOT(IY411,IA,IGUC),IS3,T)$((GDATA(IGUC,'GDUCRAMPD') LT CHRONOHOUR(IS3,T)) AND (NOT (ORD(T) EQ CARD(T))))..

 -VGF_T(IY411,IA,IGUC,IS3,T+1)
    + VGF_T(IY411,IA,IGUC,IS3,T)
         =L=
      ((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
      +VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
       /(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(IS3,T)*GDATA(IGUC,'GDUCRAMPD')
;

QRAMPING_DOWN_BALANCE(IY411,IA,IGUC,IS3,T)$((NOT (ORD(T) EQ CARD(T))) AND IAGK_HASORPOT(IY411,IA,IGUC))..


SUM(RAMPING_RATE,VRAMPING_DOWN(IY411,IA,IGUC,RAMPING_RATE,IS3,T+1))
=G=
-VGF_T(IY411,IA,IGUC,IS3,T+1)
+  VGF_T(IY411,IA,IGUC,IS3,T)
;

QRAMPING_DOWN_RATE_CAPABILITY (IY411,IA,IGUC,RAMPING_RATE,IS3,T)$((NOT (ORD(T) EQ CARD(T))) AND IAGK_HASORPOT(IY411,IA,IGUC) AND IRAMPING_G_CAPABILITY_DOWN(IGUC,RAMPING_RATE))..
VRAMPING_DOWN(IY411,IA,IGUC,RAMPING_RATE,IS3,T)
=L=
IRAMPING_G_CAPABILITY_DOWN(IGUC,RAMPING_RATE)*((GKFX(IY411,IA,IGUC)
$ifi %DECOM%==yes   -VDECOM_EXO_ACCUM(IY411,IA,IGUC)$IGDECOMEXOPOT(IY411,IA,IGUC)
+VGKNACCUMNET(IY411,IA,IGUC)$(IAGK_HASORPOT(IY411,IA,IGUC) AND IAGKN(IA,IGUC)))*(1+(1/GDATA(IGUC,'GDCB'))$IGBPR(IGUC))/(1$((NOT IGESTO(IGUC)) AND (NOT IGESTOS(IGUC)) AND (NOT IGHSTO(IGUC)) AND (NOT IGHSTOS(IGUC))) + GDATA(IGUC,'GDSTOHUNLD')$(IGESTO(IGUC) OR IGESTOS(IGUC) OR IGHSTO(IGUC) OR IGHSTOS(IGUC)))
/(GDATA(IGUC,'GDFE')*(1$(NOT GEFFRATE(IA,IGUC))+GEFFRATE(IA,IGUC))))*CHRONOHOUR(IS3,T)

;


$label  SEASONALLINKRAMPING_YES




